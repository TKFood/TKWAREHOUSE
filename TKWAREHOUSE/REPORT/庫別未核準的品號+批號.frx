<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="10/31/2022 15:06:11" ReportInfo.Modified="10/31/2022 15:14:19" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpN+i5gA3VDGcwlcfm6L9ZMsLrZ3U+wEDtHCQtd9vw2XUHXA2Q5icoFnrPixc4AX0fx">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT TH004 AS '品號',MB002 AS '品名',TH017  AS '批號', Type AS '分類',Key1 AS '單別',Key2 AS '單號',CONVERT(NVARCHAR,Key3)  AS '數量',M_MF002 AS '申請人'&#13;&#10;FROM ( &#13;&#10;SELECT TH004,TH017,'銷貨' As Type, TG001 As Key1, TG002 As Key2 ,(TH008+TH024) AS Key3&#13;&#10;,(CASE WHEN (COPTG.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..COPTG AS COPTG&#13;&#10;Left Join TK..COPTH AS COPTH ON TH001=TG001 AND TH002=TG002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=COPTG.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=COPTG.MODIFIER&#13;&#10;Where  TH007='20001' AND TG023='N'&#13;&#10;UNION ALL &#13;&#10;SELECT TB004,TB014, (CASE WHEN (MQ003 = '11') THEN '轉撥' ELSE '庫存異動' END) As Type &#13;&#10;,TA001 As Key1, TA002 As Key2  ,(TB007) AS Key3&#13;&#10;,(CASE WHEN (INVTA.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..INVTA AS INVTA&#13;&#10;LEFT JOIN TK..INVTB AS INVTB ON TB001=TA001 AND TB002=TA002&#13;&#10;LEFT JOIN TK..CMSMQ AS CMSMQ ON MQ001=TA001&#13;&#10;Left Join TK..ADMMF As A On A.MF001=INVTA.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=INVTA.MODIFIER&#13;&#10;WHERE  TB012='20001' AND TA006='N' AND MQ010=-1 &#13;&#10;UNION ALL &#13;&#10;SELECT TG004,TG017, '借出入轉撥' As Type &#13;&#10;,TF001 As Key1, TF002 As Key2 ,(TG009) AS Key3&#13;&#10;,(CASE WHEN (INVTF.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..INVTF AS INVTF&#13;&#10;LEFT JOIN TK..INVTG AS INVTG ON TG001=TF001 AND TG002=TF002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=INVTF.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=INVTF.MODIFIER&#13;&#10;WHERE  TG007='20001' AND TF020='N' &#13;&#10;UNION ALL &#13;&#10;SELECT TI004,TI017, '借出入歸還' As Type &#13;&#10;,TH001 As Key1, TH002 As Key2 ,(TI009) AS Key3&#13;&#10;,(CASE WHEN (INVTH.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..INVTH AS INVTH&#13;&#10;LEFT JOIN TK..INVTI AS INVTI ON TI001=TH001 AND TI002=TH002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=INVTH.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=INVTH.MODIFIER&#13;&#10;WHERE  TI007='20001' AND TH020='N' &#13;&#10;UNION ALL &#13;&#10;SELECT TB007,TB019, '出貨通知' As Type &#13;&#10;,TA001 As Key1, TA002 As Key2 ,(TB009+TB011) AS Key3&#13;&#10;,(CASE WHEN (EPSTA.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..EPSTA AS EPSTA&#13;&#10;LEFT JOIN TK..EPSTB AS EPSTB ON TB001=TA001 AND TB002=TA002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=EPSTA.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=EPSTA.MODIFIER&#13;&#10;WHERE  TB018='20001' AND TA034&lt;&gt;'V' &#13;&#10;AND TB021+TB022+TB023='''' AND TB042+TB043+TB044='' &#13;&#10;UNION ALL &#13;&#10;SELECT TE004,TE013, '組合單' As Type &#13;&#10;,TD001 As Key1, TD002 As Key2 ,(TE008) AS Key3&#13;&#10;,(CASE WHEN (BOMTD.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..BOMTD AS BOMTD&#13;&#10;LEFT JOIN TK..BOMTE AS BOMTE ON TE001=TD001 AND TE002=TD002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=BOMTD.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=BOMTD.MODIFIER&#13;&#10;WHERE  TE007='20001' AND TD012='N' &#13;&#10;UNION ALL &#13;&#10;SELECT TF004,TF015, '拆解單' As Type &#13;&#10;,TF001 As Key1, TF002 As Key2 ,(TF007) AS Key3&#13;&#10;,(CASE WHEN (BOMTF.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..BOMTF AS BOMTF&#13;&#10;Left Join TK..ADMMF As A On A.MF001=BOMTF.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=BOMTF.MODIFIER&#13;&#10;WHERE  TF008='20001' AND TF010='N' &#13;&#10;UNION ALL &#13;&#10;SELECT TE004,TE010, '領/退料單' As Type &#13;&#10;,TC001 As Key1, TC002 As Key2 ,(TE005) AS Key3&#13;&#10;,(CASE WHEN (MOCTC.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM TK..MOCTC AS MOCTC&#13;&#10;LEFT JOIN TK..MOCTE AS MOCTE ON TE001=TC001 AND TE002=TC002&#13;&#10;Left Join TK..ADMMF As A On A.MF001=MOCTC.CREATOR&#13;&#10;Left Join TK..ADMMF As B On B.MF001=MOCTC.MODIFIER&#13;&#10;LEFT JOIN TK..CMSMQ AS CMSMQ ON MQ001=TC001&#13;&#10;WHERE TE008='20001' AND TC009='N' &#13;&#10;AND MQ010=-1 &#13;&#10;UNION ALL &#13;&#10;SELECT TK004,TK018, '成本開帳/調整單' As Type &#13;&#10;,TJ001 As Key1, TJ002 As Key2 ,SUM(TK007) AS Key3&#13;&#10;,(CASE WHEN (INVTJ.MODIFIER &lt;&gt; '') THEN B.MF002 ELSE A.MF002 END) As M_MF002 &#13;&#10;FROM [TK].dbo.INVTJ As INVTJ&#13;&#10;LEFT JOIN [TK].dbo.INVTK AS INVTK ON TK001=TJ001 AND TK002=TJ002&#13;&#10;Left Join [TK].dbo.ADMMF As A On A.MF001=INVTJ.CREATOR&#13;&#10;Left Join [TK].dbo.ADMMF As B On B.MF001=INVTJ.MODIFIER&#13;&#10;WHERE  TK017='20001' AND TJ010='N'  &#13;&#10;GROUP BY TK004,TK018,TJ001, TJ002, INVTJ.MODIFIER,A.MF002,B.MF002&#13;&#10;HAVING (SUM(ISNULL(TK007,0)) &lt; 0) &#13;&#10;) AS MoidA &#13;&#10;LEFT JOIN [TK].dbo.INVMB ON MB001=TH004&#13;&#10;ORDER BY TH004,TH017 &#13;&#10;">
        <Column Name="品號" DataType="System.String"/>
        <Column Name="品名" DataType="System.String"/>
        <Column Name="批號" DataType="System.String"/>
        <Column Name="分類" DataType="System.String"/>
        <Column Name="單別" DataType="System.String"/>
        <Column Name="單號" DataType="System.String"/>
        <Column Name="數量" DataType="System.String"/>
        <Column Name="申請人" DataType="System.String"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210">
    <PageHeaderBand Name="PageHeader1" Width="1047.06" Height="18.9">
      <TextObject Name="Text2" Width="151.2" Height="18.9" Border.Lines="All" Text="品號" HorzAlign="Center"/>
      <TextObject Name="Text4" Left="151.2" Width="321.3" Height="18.9" Border.Lines="All" Text="品名" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text6" Left="472.5" Width="94.5" Height="18.9" Border.Lines="All" Text="批號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text8" Left="567" Width="94.5" Height="18.9" Border.Lines="All" Text="分類" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text10" Left="661.5" Width="94.5" Height="18.9" Border.Lines="All" Text="單別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text12" Left="756" Width="94.5" Height="18.9" Border.Lines="All" Text="單號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text14" Left="850.5" Width="94.5" Height="18.9" Border.Lines="All" Text="數量" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text16" Left="945" Width="94.5" Height="18.9" Border.Lines="All" Text="申請人" HorzAlign="Center" VertAlign="Center"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="23.39" Width="1047.06" Height="18.9" CanGrow="true" DataSource="Table">
      <TextObject Name="Text1" Width="151.2" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.品號]" VertAlign="Center"/>
      <TextObject Name="Text3" Left="151.2" Width="321.3" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.品名]" VertAlign="Center"/>
      <TextObject Name="Text5" Left="472.5" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.批號]" VertAlign="Center"/>
      <TextObject Name="Text7" Left="567" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.分類]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text9" Left="661.5" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.單別]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text11" Left="756" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.單號]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text13" Left="850.5" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.數量]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text15" Left="945" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.申請人]" HorzAlign="Center" VertAlign="Center"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="46.79" Width="1047.06" Height="18.9"/>
  </ReportPage>
</Report>
